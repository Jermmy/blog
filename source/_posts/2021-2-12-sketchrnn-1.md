---
title: 一个被鸽了三年的项目：sketchrnn
date: 2021-02-12 11:57:40
tags: [深度学习]
categories: 深度学习
mathjax: true
---

先给大家拜个晚年！

又好久没更新了，这次的借口是最近在死磕一个人脸修复模型的量化。同事把它从 paper 上的几百 M 压缩到 8M 后，丢给我说：来，量化吧。我一瞅网络结构，这个「电路图」绕得我七荤八素。在尝试了各种离线量化和量化训练的方案后，都达不到全精度模型的效果。后来发现并尝试了高通的 LSQ+ 算法，总算有点起色了。后面可以好好把这里面的踩坑经验和大家唠唠。

不过今天要分享的是另一个项目，一个被我鸽了三年、最近忙里偷闲做的东西。

<!--more-->

2017年的夏天，我还在读大四，当时导师让我自己看看 paper 找找研究课题。一次偶然的机会，我看到了 Google 发的一个 demo，就是下图这个东西：

<center>
  <img src="/images/2021-2-12/google_autodraw_cat.gif" width="300px">
</center>

这是一个可以自动涂鸦「sketch」的 AI 模型，我觉得蛮有意思，就翻了一下[论文「A Neural Representation of Sketch Drawings」](https://arxiv.org/abs/1704.03477)，发现里面干货贼多，好多都看不懂，相关的引用也少的可怜，而且作者还公开了一个数据集「后来 Google 又用这个数据集做了一款叫做**猜画小歌**的游戏」。

然后我就找导师聊了一下，他说 sketch 这个课题好，有数据集，做的人不多，容易毕业，让我 follow 一下。然后我就一头扎了进去，岂知这个坑越扎越深，最后逐渐跑歪成了另一个有点点沾边的课题。于是乎，这个东西就被我暂时搁置了。一直到毕业后，才慢慢开始填坑，不过直到最近摸鱼的功夫才终于把条条框框都填完了。

按照论文给的例子，这个项目可以实现以下功能：

1. **自动涂鸦**

   就是用户画一个东西后，它能自动生成相同意义的其他涂鸦：

   <center>
     <img src="/images/2021-2-12/recons.jpg" width="500px">
   </center>

   或者是帮你把没画完的涂鸦补充完：

   <center>
     <img src="/images/2021-2-12/autodraw.jpg" width="500px">
   </center>

2. **涂鸦融合**

   两个不相关的涂鸦，融合在一起会是什么样子：

   <center>
     <img src="/images/2021-2-12/morph.jpg" width="500px">
   </center>

3. **涂鸦相加减**

   这个看图就很直接了：

   <center>
     <img src="/images/2021-2-12/analogy.jpg" width="500px">
   </center>

其实你说这个项目有什么价值吗？我也不清楚，连 Google 都说它可能可以启发其他相关的研究「翻译成大白话就是这玩意暂时没价值」。不过，从最开始根本看不懂，惊为神作，到后来了解里面的每个环节，再到后来深挖细节复现，我觉得这里面涉及的知识非常丰满「RNN、Seq2Seq、MDN、VAE 等」，所以值得分享一下。

目前我主要把项目框架和算法模型搭建完了，上几张效果图：

<center>
  <img src="/images/2021-2-12/draw_cat.gif" width="400px">
</center>

<center>
  <img src="/images/2021-2-12/autodraw_cat.gif" width="400px">
</center>

如果我不说的话，你肯定猜不出这是在画一只猫吧😈。目前这个模型训练得还很差，这里面可能是训练 epoch 不够，可能是数据增强没做好，可能是模型参数不够。。。总之，有缺陷才有改进空间，才能进步，这是好事。

后面会逐步拆解几个关键的模块，并讲解如何用 pytorch 一步一步实现。针对目前效果较差的问题，我也在继续挖掘问题和改进点。涂鸦是一种很自然的交互方式，课题本身也足够有趣，希望通过一系列文章复盘我之前的研究课题，同时也让更多同学对这个课题产生兴趣。

