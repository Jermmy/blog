---
layout: post
title: Shell工具－Mac批量修改文件名
tags: [Shell, Sed]
categories: 工具
---

Mac有自带的工具Automator可以批量修改文件名，但对SE这种需要经常周游在各种*nix系统的生物来说，会用shell显然是更好的。

<!--more-->

### SED

这里面起主要作用的shell工具是SED（Stream Editor），这是一款擅长正则表达式处理的工具。

假设我们有如下命名类似的文件：

 ![屏幕快照 2016-07-05 下午7.40.05](/images/2016-7-5/屏幕快照 2016-07-05 下午7.40.05.png)

现在需要把这些文件名改为eye\_21.png~eye\_37.png， 

下面直接上一段shell代码，看看sed怎么用：

```shell
for file in `ls *.png`
do
 mv "$file" `echo "$file" | sed 's/\(.*\_.*\_\)\(.*\)/\eye_\2/g'`
done
```

（Shell里面用到命令时一定要用``包起来）

奇怪的是mac没有提供rename命令，所以只能用mv来修改文件名。现在具体看sed指令的用法。

```shell
sed 's/\(.*\_.*\_\)\(.*\)/eye_\2/g'
```

sed后面跟着一段正则表达式，用s/{reg}/g包围，双斜杆里面的{reg}就是正则表达式了，就本例子而言，需要把文件名前面的pic_s4\_更换为eye\_。具体的做法是将字符串分成两部分（即两个括号的内容）。第一个括号的内容表示 pic_s4\_，第二个括号则表示任意字符。但是怎么替换字符串呢？注意到正则表达式后面的内容(使用正则表达式时要注意用 '\\'转义)，"eye\_\2"表示替换规则。"eye\_"表示替换后的文件名字符串中以eye_开始，\2表示引用第二个括号的内容(注意需要使用\\转义)。替换后的文件名如下：

 ![屏幕快照 2016-07-05 下午8.23.57](/images/2016-7-5/屏幕快照 2016-07-05 下午8.23.57.png)

sed还有一个'-r'的参数可以让正则表达式更加简洁，但我在mac发现这个参数没法使用。

sed更多具体方法，之后有用到时再补充。