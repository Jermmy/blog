---
title: 协方差矩阵
date: 2017-03-19 09:41:39
tags: [Linear Algebra, Probability Statistics]
categories: Linear Algebra
mathjax: true

---

### 概念
协方差（Covariance）在概率论和统计学中用于衡量两个变量的总体误差。而方差是协方差的一种特殊情况，即当两个变量是相同的情况。
这个解释摘自维基百科，看起来很是抽象，不好理解。其实简单来讲，协方差就是衡量两个变量相关性的变量。当协方差为正时，两个变量呈正相关关系（同增同减）；当协方差为负时，两个变量呈负相关关系（一增一减）。
而协方差矩阵，只是将所有变量的协方差关系用矩阵的形式表现出来而已。通过矩阵这一工具，可以更方便地进行数学运算。
<!--more-->
### 数学定义
回想概率统计里面关于方差的数学定义：
$$
Var(X)=\frac{\sum\_{i=1}^n{(x\_i-\overline x)(x\_i-\overline x)}}{n-1}
$$
协方差的数学定义异曲同工：
$$
Cov(X,Y)=\frac{\sum\_{i=1}^n{(x\_i-\overline x)(y\_i-\overline y)}}{n-1}
$$
这里的 $X$，$Y$ 表示两个变量空间。用机器学习的话讲，就是样本有 $x$ 和 $y$ 两种特征，而 $X$ 就是包含所有样本的 $x$ 特征的集合，$Y$ 就是包含所有样本的 $y$ 特征的集合。
### 协方差矩阵
有了上面的数学定义后，我们可以来讨论协方差矩阵了。

用一个例子来解释会更加形象。

假设我们有 4 个样本，每个样本都有两个变量，也就是两个特征，它们表示如下：
$x_1=(1,2)$
$x_2=(3,6)$
$x_3=(4,2)$
$x_4=(5,2)$
用一个矩阵表示为：
$
Z=\begin{bmatrix}
1 & 2 \\\\
3 & 6 \\\\
4 & 2 \\\\
5 & 2
\end{bmatrix}
$
现在，我们用两个变量空间 $X$，$Y$ 来表示这两个特征：
$X=\begin{bmatrix} 1 \\\\ 3 \\\\ 4 \\\\ 5 \end{bmatrix}$，$Y=\begin{bmatrix} 2 \\\\ 6 \\\\ 2 \\\\ 2 \end{bmatrix}$
由于协方差反应的是两个变量之间的相关性，因此，协方差矩阵表示的是所有变量之间两两相关的关系，具体来讲，一个包含两个特征的矩阵，其协方差矩阵应该有 $2*2$ 大小：
$Cov(Z)=\begin{bmatrix} Cov(X,X) & Cov(X,Y) \\\\ Cov(Y,X) & Cov(Y,Y) \end{bmatrix}$
接下来，就来逐一计算 $Cov(Z)$ 的值。
首先，我们需要先计算出 $X$，$Y$ 两个特征空间的平均值：$\overline x=3.25$，$\overline y=3$。
然后，根据协方差的数学定义，计算协方差矩阵的每个元素：
$Cov(X,X)=\frac{(1-3.25)^2+(3-3.25)^2+(4-3.25)^2+(5-3.25)^2}{4-1}=2.9167$
$Cov(X,Y)=\frac{(1-3.25)(2-3)+(3-3.25)(6-3)+(4-3.25)(2-3)+(5-3.25)(2-3)}{4-1}=-0.3333$
$Cov(Y,X)=\frac{(2-3)(1-3.25)+(6-3)(3-3.25)+(2-3)(4-3.25)+(2-3)(5-3.25)}{4-1}=-0.3333$
$Cov(Y,X)=\frac{(2-3)^2+(6-3)^2+(2-3)^2+(2-3)^2}{4-1}=4$
所以协方差矩阵 $Cov(Z)=\begin{bmatrix} 2.9167 & -0.3333 \\\\ -0.3333 & 4.000 \end{bmatrix}$

好了，虽然这只是一个二维特征的例子，但我们已经可以从中总结出协方差矩阵$\Sigma$的计算**套路**：
$\Sigma_{ij}=\frac{(样本矩阵第i列-第i列均值)^T(样本矩阵第j列-第j列均值)}{样本数-1}$
这里所说的样本矩阵可以参考上面例子中的 $Z$。

### 参考
[详解协方差与协方差矩阵](http://blog.csdn.net/ybdesire/article/details/6270328)
[浅谈协方差矩阵](http://pinkyjie.com/2010/08/31/covariance/)
[协方差](https://zh.wikipedia.org/wiki/%E5%8D%8F%E6%96%B9%E5%B7%AE)




